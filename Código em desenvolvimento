Private Sub ProcessarDadosSap1(ByVal dadosSap1 As Worksheet, ByRef dict_Sap1 As Object, ByRef sumDict_Pedido As Object, ByRef sumDict_Nf As Object)
    Dim dadosSap1Range As Range, dadosSap1Values As Variant
    Dim chave_Req As String, chave_Pedido As String, valor As Double
    Dim i As Long

    Set dict_Sap1 = CreateObject("Scripting.Dictionary")
    Set sumDict_Pedido = CreateObject("Scripting.Dictionary")
    Set sumDict_Nf = CreateObject("Scripting.Dictionary")

    Set dadosSap1Range = dadosSap1.Range("C2:H" & dadosSap1.Cells(dadosSap1.Rows.Count, "H").End(xlUp).Row)
    dadosSap1Values = dadosSap1Range.Value

    ' Looping através do array em vez de diretamente na planilha
    For i = 1 To UBound(dadosSap1Values, 1)
        chave_Req = Trim(dadosSap1Values(i, 1))
        chave_Pedido = Trim(dadosSap1Values(i, 3))
        valor = dadosSap1Values(i, 6)

        ' Adiciona a relação chave_Req e chave_Pedido ao dicionário
        If chave_Req <> "" Then
            dict_Sap1(chave_Req) = chave_Pedido
        End If

        ' Verificações combinadas para sumDict_Pedido e sumDict_Nf
        If chave_Pedido <> "" Then
            ' Soma ao sumDict_Pedido
            If sumDict_Pedido.Exists(chave_Pedido) Then
                sumDict_Pedido(chave_Pedido) = sumDict_Pedido(chave_Pedido) + valor
            Else
                sumDict_Pedido.Add chave_Pedido, valor
            End If

            ' Verifica condições adicionais para sumDict_Nf
            If Not IsEmpty(dadosSap1Values(i, 5)) And Trim(dadosSap1Values(i, 5)) <> "" And _
               Not IsEmpty(dadosSap1Values(i, 7)) And Trim(dadosSap1Values(i, 7)) <> "" Then
                If sumDict_Nf.Exists(chave_Pedido) Then
                    sumDict_Nf(chave_Pedido) = sumDict_Nf(chave_Pedido) + valor
                Else
                    sumDict_Nf.Add chave_Pedido, valor
                End If
            End If
        End If
    Next i
End Sub
